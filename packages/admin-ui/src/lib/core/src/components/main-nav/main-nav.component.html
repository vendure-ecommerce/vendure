<nav class="main-nav pr-6 pl-4">
    <ng-container *ngFor="let section of mainMenuConfig$ | async">
        <div
            class="overflow-hidden transition-all pb-2 nav-group first:pt-4"
            [attr.data-section-id]="section.id"
            [class.collapsible]="section.collapsible"
            [class.collapsed]="section.collapsible && !expandedSections.includes(section.id)"
            routerLinkActive="active"
            (isActiveChange)="setExpanded(section, $event)"
            *ngIf="shouldDisplayLink(section)"
        >
            <vdr-ui-extension-point
                [locationId]="section.id"
                api="navMenu"
                [topPx]="0"
                [leftPx]="8"
                display="block"
            >
                <div class="section-header">
                    <ng-container
                        *ngIf="navBuilderService.sectionBadges[section.id] | async as sectionBadge"
                    >
                        <vdr-status-badge
                            *ngIf="sectionBadge !== 'none'"
                            [type]="sectionBadge"
                        ></vdr-status-badge>
                    </ng-container>
                    <label class="nav-group-header mx-4" [for]="section.id">{{
                        section.label | translate
                    }}</label>
                    <button *ngIf="section.collapsible" class="rounded-full bg-gray-200 h-5 w-5 flex items-center justify-center" (click)="toggleExpand(section)">
                        <clr-icon
                            [attr.shape]="expandedSections.includes(section.id) ? 'caret up' : 'caret down'"
                            class="h-3 w-3"
                            [title]="'common.expand-entries' | translate"
                        ></clr-icon>
                    </button>
                </div>
                <div class="nav-list" [ngStyle]="getStyleForSection(section)">
                    <ng-container *ngFor="let item of section.items">
                        <div
                            *ngIf="shouldDisplayLink(item)"
                            class="nav-link"
                            routerLinkActive="active"
                        >
                            <a
                                [attr.data-item-id]="section.id"
                                [routerLink]="getRouterLink(item)"
                                (click)="onItemClick(item, $event)"
                            >
                                <ng-container *ngIf="item.statusBadge | async as itemBadge">
                                    <vdr-status-badge
                                        *ngIf="itemBadge.type !== 'none'"
                                        [type]="itemBadge.type"
                                    ></vdr-status-badge>
                                </ng-container>
                                <clr-icon
                                    [attr.shape]="item.icon || 'block'"
                                    class="h-4 w-4 nav-link-icon"
                                    [title]="item.label | translate"
                                ></clr-icon>
                                <span class="">{{ item.label | translate }}</span>
                            </a>
                        </div>
                    </ng-container>
                </div>
            </vdr-ui-extension-point>
        </div>
    </ng-container>
</nav>
